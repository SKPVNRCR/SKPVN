<head>
  <meta charset="UTF-8">
  <title>Admin Panel | Article Manager</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Kannada&amp;display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans Kannada', sans-serif;
      background-color: #fff8f0;
      padding: 2rem;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #800000;
      margin-bottom: 2rem;
    }

    /* Card-like styling for author sections */
    .author-section {
      border: 2px solid #ccc;
      padding: 1rem;
      margin-bottom: 1rem;
      background: #fffef9;
      border-left: 6px solid #8e1515;
      border-radius: 8px;
    }

    .entry-controls {
      margin-top: 0.5rem;
    }

    .entry-controls button {
      margin-right: 10px;
      padding: 5px 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .entry-controls .edit { background: #e0e0e0; }
    .entry-controls .delete { background: #ffdddd; }
    .entry-controls .approve { background: #ddffdd; }

    input, textarea, select {
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      width: 100%;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button.add-btn {
      background-color: #800000;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 1rem;
    }

    .collapsible {
      font-weight: bold;
      background: #8e1515;
      color: white;
      padding: 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      text-align: left;
      width: 100%;
      position: relative;
    }
    .collapsible::after {
      content: '‚ñº';
      position: absolute;
      right: 20px;
      font-size: 0.9rem;
      top: 50%;
      transform: translateY(-50%);
      transition: transform 0.3s ease;
    }
    .collapsible.active::after {
      transform: translateY(-50%) rotate(180deg);
    }

    .content {
      display: none;
      padding: 10px;
      margin-top: 5px;
      background: #f9f9f9;
      border-radius: 6px;
    }
    .content pre {
      white-space: pre-wrap;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <h1>Admin Panel - ‡≤≤‡≥á‡≤ñ‡≤®‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤ï‡≤µ‡≤®‡≤ó‡≤≥‡≥Å</h1>

  <!-- Submission manager -->
  <h2>üïí Pending Submissions</h2>
  <div id="pending-entries"></div>

  <hr>

  <!-- Form for adding approved entries directly -->
  <div>
    <h2>‚ûï Add Approved Entry</h2>
    <input type="text" id="author" placeholder="‡≤≤‡≥á‡≤ñ‡≤ï‡≤∞ ‡≤π‡≥Ü‡≤∏‡≤∞‡≥Å">
    <input type="text" id="title" placeholder="‡≤∂‡≥Ä‡≤∞‡≥ç‡≤∑‡≤ø‡≤ï‡≥Ü">
    <select id="type">
      <option value="üìò Article">üìò Article</option>
      <option value="üìù Poem">üìù Poem</option>
    </select>
    <textarea id="content" rows="5" placeholder="‡≤≤‡≥á‡≤ñ‡≤® ‡≤Ö‡≤•‡≤µ‡≤æ ‡≤ï‡≤µ‡≤®"></textarea>
    <button class="add-btn" onclick="addEntry()">‚ûï Add Entry</button>
  </div>

  <hr>

  <!-- Approved articles/poems list -->
  <h2>‚úÖ Approved Articles & Poems</h2>
  <div id="entries"></div>

  <script>
    // Retrieve existing approved articles and pending submissions from localStorage
    let articles = JSON.parse(localStorage.getItem('articles')) || [];
    let pending = JSON.parse(localStorage.getItem('submissions')) || [];

    /**
     * Persist both collections to localStorage and re-render lists.
     */
    function updateStorage() {
      localStorage.setItem('articles', JSON.stringify(articles));
      localStorage.setItem('submissions', JSON.stringify(pending));
      renderPending();
      renderArticles();
    }

    /**
     * Render the list of pending submissions with approve/reject controls.
     */
    function renderPending() {
      const container = document.getElementById('pending-entries');
      container.innerHTML = '';
      if (pending.length === 0) {
        container.innerHTML = '<p>No pending submissions.</p>';
        return;
      }
      pending.forEach((entry, index) => {
        const div = document.createElement('div');
        div.className = 'author-section';
        const h3 = document.createElement('h3');
        h3.innerText = entry.author;
        const collapsible = document.createElement('button');
        collapsible.className = 'collapsible';
        collapsible.innerText = `${entry.type}: ${entry.title}`;
        collapsible.onclick = () => {
          const content = div.querySelector('.content');
          collapsible.classList.toggle('active');
          content.style.display = content.style.display === 'block' ? 'none' : 'block';
        };
        const content = document.createElement('div');
        content.className = 'content';
        content.innerHTML = `<pre>${entry.content}</pre>`;
        const controls = document.createElement('div');
        controls.className = 'entry-controls';
        // Approve button
        const approveBtn = document.createElement('button');
        approveBtn.className = 'approve';
        approveBtn.innerText = '‚úÖ Approve';
        approveBtn.onclick = () => {
          // Move entry from pending to articles and mark approved
          const approvedEntry = { ...entry, approved: true };
          articles.push(approvedEntry);
          pending.splice(index, 1);
          updateStorage();
        };
        // Reject (delete) button
        const rejectBtn = document.createElement('button');
        rejectBtn.className = 'delete';
        rejectBtn.innerText = 'üóë Reject';
        rejectBtn.onclick = () => {
          if (confirm('Are you sure you want to reject this submission?')) {
            pending.splice(index, 1);
            updateStorage();
          }
        };
        controls.appendChild(approveBtn);
        controls.appendChild(rejectBtn);
        div.appendChild(h3);
        div.appendChild(collapsible);
        div.appendChild(content);
        div.appendChild(controls);
        container.appendChild(div);
      });
    }

    /**
     * Render the list of approved articles and poems with edit/delete options.
     */
    function renderArticles() {
      const container = document.getElementById('entries');
      container.innerHTML = '';
      if (articles.length === 0) {
        container.innerHTML = '<p>No approved articles or poems.</p>';
        return;
      }
      articles.forEach((entry, index) => {
        const div = document.createElement('div');
        div.className = 'author-section';
        const h3 = document.createElement('h3');
        h3.innerText = entry.author;
        const collapsible = document.createElement('button');
        collapsible.className = 'collapsible';
        collapsible.innerText = `${entry.type}: ${entry.title}`;
        collapsible.onclick = () => {
          const content = div.querySelector('.content');
          collapsible.classList.toggle('active');
          content.style.display = content.style.display === 'block' ? 'none' : 'block';
        };
        const content = document.createElement('div');
        content.className = 'content';
        content.innerHTML = `<pre>${entry.content}</pre>`;
        const controls = document.createElement('div');
        controls.className = 'entry-controls';
        // Edit button
        const editBtn = document.createElement('button');
        editBtn.className = 'edit';
        editBtn.innerText = '‚úèÔ∏è Edit';
        editBtn.onclick = () => {
          const newAuthor = prompt('Author:', entry.author);
          const newTitle = prompt('Title:', entry.title);
          const newContent = prompt('Content:', entry.content);
          if (newAuthor && newTitle && newContent) {
            articles[index] = {
              ...entry,
              author: newAuthor,
              title: newTitle,
              content: newContent
            };
            updateStorage();
          }
        };
        // Delete button
        const delBtn = document.createElement('button');
        delBtn.className = 'delete';
        delBtn.innerText = 'üóë Delete';
        delBtn.onclick = () => {
          if (confirm('Are you sure you want to delete this entry?')) {
            articles.splice(index, 1);
            updateStorage();
          }
        };
        controls.appendChild(editBtn);
        controls.appendChild(delBtn);
        div.appendChild(h3);
        div.appendChild(collapsible);
        div.appendChild(content);
        div.appendChild(controls);
        container.appendChild(div);
      });
    }

    /**
     * Add a new article or poem directly to the approved list via the admin
     * interface. A unique id is created to maintain consistency with
     * submissions.
     */
    function addEntry() {
      const author = document.getElementById('author').value;
      const title = document.getElementById('title').value;
      const type = document.getElementById('type').value;
      const content = document.getElementById('content').value;
      if (!author || !title || !content) {
        alert('Fill all fields');
        return;
      }
      const id = Date.now().toString();
      articles.push({ id, author, title, type, content, approved: true });
      // Clear form
      document.getElementById('author').value = '';
      document.getElementById('title').value = '';
      document.getElementById('content').value = '';
      updateStorage();
    }

    // Initial render on page load
    renderPending();
    renderArticles();
  </script>
</body>